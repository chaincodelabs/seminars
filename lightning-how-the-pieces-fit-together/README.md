# How the layers of Lightning Fit Together

## Reading

| Content                                                                                       | Time  | Tags                    |
|-----------------------------------------------------------------------------------------------|-------|-------------------------|
[A walk through the layers of Lightning](https://www.youtube.com/watch?v=tie0Gpq2eJI) | 30 min | LN layers, video |
[The Update Layer](https://youtu.be/SoFlRCNdqDg) | 60 min | update, video |
[The Transfer Layer](https://youtu.be/CGE8I8L7BAc) | 41 min | transfer, video |
[The Multihop Layer](https://youtu.be/P7I-C0_sijg) | 72 min | multihop, video |
[The other layers (base and transport)](https://youtu.be/wyri7cc83kQ) | 17 min | base, transport, video |
[Diffie–Hellman key exchange](https://en.wikipedia.org/wiki/Diffie%E2%80%93Hellman_key_exchange) | 10 min | Diffie–Hellman, cryptography |
[How and when do I use HMAC?](https://security.stackexchange.com/questions/20129/how-and-when-do-i-use-hmac) | 10 min | HMAC, cryptography |

## Discussion Questions

1. How is the payment hash sent over to the payer?
2. Explain how the timeout mechanism works for in-flight HTLCs?
3. How would an offline vending machine work?
4. Why did transaction malleability need to be fixed on the base layer and how would it have affected Lightning?
5. What are routing hints and why are they important for private channels?
